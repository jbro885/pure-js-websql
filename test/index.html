<!DOCTYPE html>
<html>
<head>
<script src='https://raw.github.com/kripken/sql.js/master/js/sql.js'></script>
<script src='../js/purejswebsql.js'></script>
<script>
openDatabase = purejsOpenDatabase;
</script>

<script>
function $(selector) {
	var id = selector.substring(1); // trivial implementation
	return document.getElementById(id);
}

var db = openDatabase('mydb', '1.0', 'my first database', 2 * 1024 * 1024);

function showValues() {
	db.transaction(function (tx) {
		var queries = $('#sqlcode').value.split(';');
		for (var k = 0; k < queries.length; k++) {
			queries[k] = queries[k].trim();
			if (queries[k].length === 0) {
				queries.splice(k, 1);
				k--;
			}
		};
		for (var j = 0; j < queries.length - 1; j++) {
			tx.executeSql(queries[j], [], function(){}, function(tx, e) {console.log(e)});
		}

		if (queries.length > 0) {
			tx.executeSql(queries[queries.length - 1], [], function (tx, results) {
				var len = results.rows.length;
				var text = '';
				for (var i = 0; i < len; i++) {
					text += JSON.stringify(results.rows.item(i)) + '<br/>';
				}
				$('#values').innerHTML = text;
			}, function(tx, e) {console.log(e)});
		}
	});
}
</script>
<script src=""></script>
</head>
<body>
<textarea id='sqlcode' cols='80' rows='8'>
DROP TABLE IF EXISTS foo;
CREATE TABLE IF NOT EXISTS foo (id unique, text);
INSERT INTO foo (id, text) VALUES (1, "synergies");
INSERT INTO foo (id, text) VALUES (2, "synergies2");
SELECT * FROM foo;
</textarea>
<br/>
<input type='button' value='Show result' onclick='showValues()' />

<div id='values'/>
</body>
</html>
